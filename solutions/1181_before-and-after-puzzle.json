{
    "problemName": "before-and-after-puzzle",
    "language": "cpp",
    "code": "class  Solution  {   public :   vector < string >  beforeAndAfterPuzzles ( vector < string >&  phrases )  {   set < string >  ans ;   unordered_map < string ,  set < string >>  firstWordToLasts ;   unordered_map < string ,  set < string >>  lastWordToFirsts ;   for  ( const  string &  phrase  :  phrases )  {   const  int  firstSpaceIndex  =  phrase . find ( ' ' );   const  int  lastSpaceIndex  =  phrase . rfind ( ' ' );     const  int  i  =   firstSpaceIndex  ==  string :: npos  ?  phrase . length ()  :  firstSpaceIndex ;     const  int  j  =  lastSpaceIndex  ==  string :: npos  ?  0  :  lastSpaceIndex  +  1 ;   const  string  firstWord  =  phrase . substr ( 0 ,  i );   const  string  lastWord  =  phrase . substr ( j );     if  ( const  auto  it  =  firstWordToLasts . find ( lastWord );   it  !=  firstWordToLasts . cend ())   for  ( const  string &  last  :  it -> second )   ans . insert ( phrase  +  last );     if  ( const  auto  it  =  lastWordToFirsts . find ( firstWord );   it  !=  lastWordToFirsts . cend ())   for  ( const  string &  first  :  it -> second )   ans . insert ( first  +  phrase );       firstWordToLasts [ firstWord ]. insert ( phrase . substr ( i ));       lastWordToFirsts [ lastWord ]. insert ( phrase . substr ( 0 ,  j ));   }   return  { ans . begin (),  ans . end ()};   }  }; "
}